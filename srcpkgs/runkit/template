# Template file for 'runkit'
pkgname=runkit
version=0.1.0
revision=1
build_style=cargo
hostmakedepends="pkg-config gtk4-devel libadwaita-devel glib-devel pango-devel"
makedepends="gtk4-devel libadwaita-devel glib-devel pango-devel"
short_desc="GUI manager for runit services"
maintainer="nerdyslacker <karyan40024@gmail.com>"
license="MIT"
homepage="https://github.com/lazylinuxos/runkit"
distfiles="https://github.com/lazylinuxos/runkit/archive/refs/tags/${version}.tar.gz"
checksum=8c949c58416189c02e42b6709e78f7d68ce3557256af7e387603cffe50888d5d

do_install() {
	vinstall target/x86_64-unknown-linux-gnu/release/runkit 755 usr/libexec
	vinstall target/x86_64-unknown-linux-gnu/release/runkitd 755 usr/libexec

	for size in 16x16 24x24 32x32 48x48 64x64 96x96 128x128 256x256 512x512; do
		vinstall "assets/icons/hicolor/${size}/apps/runkit.png" 644 "usr/share/icons/hicolor/${size}/apps" "runkit.png"
	done

	vinstall assets/icons/hicolor/scalable/apps/runkit.svg 644 usr/share/icons/hicolor/scalable/apps runkit.svg
    vinstall assets/applications/tech.geektoshi.Runkit.desktop 644 usr/share/applications tech.geektoshi.Runkit.desktop
	vinstall assets/dbus-1/services/tech.geektoshi.Runkit.service 644 usr/share/dbus-1/services tech.geektoshi.Runkit.service 
    vinstall assets/polkit-1/actions/tech.geektoshi.Runkit.policy 644 usr/share/polkit-1/actions tech.geektoshi.Runkit.policy

    vlicense LICENSE
}

post_install() {
	if [ -x /usr/bin/gtk-update-icon-cache ]; then
		/usr/bin/gtk-update-icon-cache -f usr/share/icons/hicolor || true
	fi
	if [ -x /usr/bin/update-desktop-database ]; then
		/usr/bin/update-desktop-database usr/share/applications || true
	fi
}
