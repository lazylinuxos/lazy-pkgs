# Template file for 'wails'
pkgname=wails
version=2.10.2
revision=1
archs="x86_64"
build_style=go
go_import_path="github.com/wailsapp/wails/v2"
go_package="./cmd/wails"
hostmakedepends="nodejs"
makedepends="gtk+3-devel libwebkit2gtk41-devel"
depends="gtk+3 glibc libwebkit2gtk41"
short_desc="Create desktop apps using Go and Web Technologies"
maintainer="nerdyslacker <karyan40024@gmail.com>"
license="MIT"
homepage="https://github.com/wailsapp/wails"
distfiles="https://github.com/wailsapp/wails/archive/v${version}/wails-${version}.tar.gz"
checksum=864b53f22ca98ed17e456b352ec4691cfc2105bdcb23e87df8f826035b08d8c0

do_build() {
    cd v2
    export CGO_CPPFLAGS="${CPPFLAGS}"
    export CGO_CFLAGS="${CFLAGS}"
    export CGO_CXXFLAGS="${CXXFLAGS}"
    export CGO_LDFLAGS="${LDFLAGS}"
    export GOFLAGS="-buildmode=pie -trimpath -ldflags=-linkmode=external -mod=readonly -modcacherw"

    go build -o build/ ./cmd/wails
}

do_install() {
    vbin v2/build/wails

    vinstall CHANGELOG.md 644 usr/share/doc/wails
    vinstall CONTRIBUTORS.md 644 usr/share/doc/wails
    vinstall README.md 644 usr/share/doc/wails
    vlicense LICENSE
}